document.addEventListener("DOMContentLoaded", () => {
  const loginContainer = document.getElementById("login-container");
  const cadastroContainer = document.getElementById("cadastro-container");
  const menu = document.getElementById("menu");
  const abas = document.querySelectorAll(".aba");
  const toggleDark = document.getElementById("toggle-dark");

  // TROCAR TELA LOGIN/CADASTRO
  document.getElementById("mostrar-cadastro").addEventListener("click", e => {
    e.preventDefault();
    loginContainer.classList.add("hidden");
    cadastroContainer.classList.remove("hidden");
  });

  document.getElementById("mostrar-login").addEventListener("click", e => {
    e.preventDefault();
    cadastroContainer.classList.add("hidden");
    loginContainer.classList.remove("hidden");
  });

  // LOGIN FIXO (Luis)
  document.getElementById("login-form").addEventListener("submit", e => {
    e.preventDefault();
    const usuario = document.getElementById("login-usuario").value;
    const senha = document.getElementById("login-senha").value;
    if (usuario === "luis" && senha === "luisxl") {
      loginContainer.classList.add("hidden");
      menu.classList.remove("hidden");
      document.getElementById("painel").classList.remove("hidden");
    } else {
      alert("Usuário ou senha inválidos!");
    }
  });

  // CADASTRO SIMPLES
  document.getElementById("cadastro-form").addEventListener("submit", e => {
    e.preventDefault();
    alert("Cadastro realizado com sucesso!");
    cadastroContainer.classList.add("hidden");
    loginContainer.classList.remove("hidden");
    document.getElementById("cadastro-form").reset();
  });

  // TROCAR ABAS
  document.querySelectorAll("nav#menu button[data-aba]").forEach(btn => {
    btn.addEventListener("click", () => {
      abas.forEach(aba => aba.classList.add("hidden"));
      document.getElementById(btn.dataset.aba).classList.remove("hidden");
    });
  });

  // LOGOUT
  document.getElementById("logout").addEventListener("click", () => {
    menu.classList.add("hidden");
    abas.forEach(aba => aba.classList.add("hidden"));
    loginContainer.classList.remove("hidden");
    // limpar campos
    document.getElementById("login-form").reset();
    document.getElementById("cadastro-form").reset();
    document.getElementById("func-form").reset();
  });

  // CHAT SIMPLES
  const chatBox = document.getElementById("chat-box");
  document.getElementById("chat-enviar").addEventListener("click", () => {
    const input = document.getElementById("chat-input");
    if (input.value.trim() !== "") {
      const userMsg = document.createElement("div");
      userMsg.classList.add("msg", "user");
      userMsg.textContent = "Você: " + input.value;
      chatBox.appendChild(userMsg);

      setTimeout(() => {
        const hotelMsg = document.createElement("div");
        hotelMsg.classList.add("msg", "hotel");
        hotelMsg.textContent = "Hotel: Recebido!";
        chatBox.appendChild(hotelMsg);
      }, 1000);

      input.value = "";
    }
  });

  // FEEDBACK
  document.getElementById("feedback-form").addEventListener("submit", e => {
    e.preventDefault();
    const funcionario = document.getElementById("feedback-funcionario").value;
    const servico = document.getElementById("feedback-servico").value;
    const texto = document.getElementById("feedback-texto").value;
    if (funcionario && servico && texto.trim() !== "") {
      alert(`Feedback enviado para ${servico}, atendido por ${funcionario}. Obrigado!`);
      e.target.reset();
    }
  });

  // SERVIÇOS
  const detalhesServico = document.getElementById("detalhes-servico");
  document.getElementById("servico-select").addEventListener("change", e => {
    const servico = e.target.value;
    detalhesServico.innerHTML = "";

    if (servico === "refeicao") {
      detalhesServico.innerHTML = `
        <h3>Escolha o tipo:</h3>
        <button type="button" class="tipo-refeicao" data-tipo="prato">Prato</button>
        <button type="button" class="tipo-refeicao" data-tipo="bebida">Bebida</button>
        <button type="button" class="tipo-refeicao" data-tipo="sobremesa">Sobremesa</button>
        <div id="opcoes-refeicao"></div>
      `;

      document.querySelectorAll(".tipo-refeicao").forEach(btn => {
        btn.addEventListener("click", () => {
          const tipo = btn.dataset.tipo;
          const opcoesDiv = document.getElementById("opcoes-refeicao");
          if (tipo === "prato") {
            opcoesDiv.innerHTML = `
              <div>
                <img src="https://via.placeholder.com/80" alt="Prato">
                <p>Prato Executivo - R$25,00 - 20min</p>
              </div>
              <div>
                <img src="https://via.placeholder.com/80" alt="Prato">
                <p>Macarrão à Bolonhesa - R$30,00 - 25min</p>
              </div>
            `;
          } else if (tipo === "bebida") {
            opcoesDiv.innerHTML = `
              <div>
                <img src="https://via.placeholder.com/80" alt="Bebida">
                <p>Suco Natural - R$8,00 - 5min</p>
              </div>
              <div>
                <img src="https://via.placeholder.com/80" alt="Bebida">
                <p>Refrigerante - R$6,00 - 2min</p>
              </div>
            `;
          } else if (tipo === "sobremesa") {
            opcoesDiv.innerHTML = `
              <div>
                <img src="https://via.placeholder.com/80" alt="Sobremesa">
                <p>Pudim - R$12,00 - 10min</p>
              </div>
              <div>
                <img src="https://via.placeholder.com/80" alt="Sobremesa">
                <p>Bolo de Chocolate - R$15,00 - 15min</p>
              </div>
            `;
          }
        });
      });
    } else if (servico === "limpeza") {
      detalhesServico.innerHTML = `
        <label>Selecione o dia:</label>
        <input type="date" id="servico-dia" style="width:150px">
        <label>Selecione a hora:</label>
        <input type="time" id="servico-hora" style="width:150px">
        <button type="submit">Agendar</button>
      `;
    } else if (servico === "toalhas") {
      let opcoes = "";
      for (let i = 0; i <= 30; i += 5) {
        opcoes += `<option value="${i}">${i} minutos</option>`;
      }
      detalhesServico.innerHTML = `
        <label>Entrega em:</label>
        <select id="toalhas-tempo">${opcoes}</select>
        <button type="submit">Solicitar</button>
      `;
    }
  });

  document.getElementById("servicos-form").addEventListener("submit", e => {
    e.preventDefault();
    const servico = document.getElementById("servico-select").value;
    if (servico === "limpeza") {
      const dia = document.getElementById("servico-dia").value;
      const hora = document.getElementById("servico-hora").value;
      if (dia && hora) {
        alert(`Serviço de limpeza agendado para ${dia} às ${hora}`);
        e.target.reset();
        detalhesServico.innerHTML = "";
      }
    } else if (servico === "toalhas") {
      const tempo = document.getElementById("toalhas-tempo").value;
      alert(`Toalhas serão entregues em ${tempo} minutos`);
      e.target.reset();
      detalhesServico.innerHTML = "";
    }
  });

  // BOTÃO ALTO CONTRASTE
  toggleDark.addEventListener("click", () => {
    document.body.classList.toggle("contraste");
  });

  // LOGIN FUNCIONÁRIOS (igual login inicial)
  document.getElementById("func-form").addEventListener("submit", e => {
    e.preventDefault();
    const usuario = document.getElementById("func-nome").value;
    const senha = document.getElementById("func-senha").value;
    if (usuario === "luis" && senha === "luisxl") {
      document.getElementById("func-login").classList.add("hidden");
      const bemvindo = document.getElementById("func-bemvindo");
      bemvindo.textContent = `Seja bem-vindo funcionário ${usuario}`;
      bemvindo.classList.remove("hidden");
    } else {
      alert("Usuário ou senha inválidos para funcionário!");
    }
  });
});
